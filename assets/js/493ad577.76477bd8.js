"use strict";(self.webpackChunkambirdsall_com=self.webpackChunkambirdsall_com||[]).push([[4361],{5273:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"noisebot/mini-keyboard","title":"Setting Up The Mini Keyboard","description":"This part of the project began with a little investigation: what key codes does it actually send?","source":"@site/projects/noisebot/mini-keyboard.mdx","sourceDirName":"noisebot","slug":"/noisebot/mini-keyboard","permalink":"/projects/noisebot/mini-keyboard","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"projectSidebar","previous":{"title":"I, Noisebot","permalink":"/projects/noisebot/"},"next":{"title":"Setting Up The Rasperry Pi Zero W","permalink":"/projects/noisebot/raspberry-pi-zero"}}');var s=t(4848),r=t(8453);const i={},a="Setting Up The Mini Keyboard",d={},l=[{value:"defining a new layout for the keyboard",id:"defining-a-new-layout-for-the-keyboard",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"setting-up-the-mini-keyboard",children:"Setting Up The Mini Keyboard"})}),"\n",(0,s.jsx)(n.p,{children:"This part of the project began with a little investigation: what key codes does it actually send?"}),"\n",(0,s.jsx)(n.p,{children:"The product listing on aliexpress claimed the keyboard would come with software for remapping keys, but there was literally nothing in the box but the keyboard and a cable. No manual, no piece of paper with a url\u2014hell, I didn't even a brand name to google."}),"\n",(0,s.jsxs)(n.p,{children:["So. I plugged the keyboard into my laptop, ran ",(0,s.jsx)(n.code,{children:"cat -v"})," in a terminal, and started fiddling. And lo: ",(0,s.jsx)(n.em,{children:"literally everything"})," sent the letter ",(0,s.jsx)(n.code,{children:"c"}),". The 6 keys? Every one a ",(0,s.jsx)(n.code,{children:"c"}),". Turn the knob clockwise, it sends one ",(0,s.jsx)(n.code,{children:"c"})," per tick. Counterclockwise? More ",(0,s.jsx)(n.code,{children:"c"}),"s. Press the knob? You guessed it. While I kinda respected this heinous default's commitment to the bit, it was unusable: I had to replace the firmware to get a useful set of keycodes."]}),"\n",(0,s.jsxs)(n.p,{children:["I searched all over the web for the keyboard by description, with and without ",(0,s.jsx)(n.code,{children:"aliexpress"})," appended to the search, but all I found were old forum posts with broken links and rumors of a malware-ridden, windows-only keyboard mapper provided by the company that I could maybe run in a VM."]}),"\n",(0,s.jsxs)(n.p,{children:["I got fed up before I found a copy, so I opened up the case, wrote down what I saw on the circuit board, and searched for that instead. That was a much better idea; I soon found ",(0,s.jsx)(n.a,{href:"https://github.com/kriomant/ch57x-keyboard-tool",children:(0,s.jsx)(n.code,{children:"ch57x-keyboard-tool"})}),", a rust project for doing exactly what I needed to do, supporting hardware suspiciously similar to mine."]}),"\n",(0,s.jsx)(n.h2,{id:"defining-a-new-layout-for-the-keyboard",children:"defining a new layout for the keyboard"}),"\n",(0,s.jsxs)(n.p,{children:['Here\'s the keyboard layout I used. There were 2 rows of 3 keys each, and every key needed a job. On the bottom row were three keys to toggle whether specific other speakers were grouped with the line in; on top was one to connect the line in audio source, and... two more. Better to have and not need, I guess? Those got the "forward track" and "backward track" actions, in case I\'m streaming digital tracks on a group of sonos speakers that includes the line in. Turning the knob should change volume, of course; pressing it should toggle mute. Nothing fancy like RGB lighting',(0,s.jsx)(n.sup,{children:(0,s.jsx)(n.a,{href:"#user-content-fn-5",id:"user-content-fnref-5","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"."]}),"\n",(0,s.jsx)(n.p,{children:'Each "job" is mapped to a mnemonic letter key, even media functions that have dedicated keycodes:'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["back row of keyboard buttons","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["[",(0,s.jsx)(n.strong,{children:"b"}),"]ackwards track"]}),"\n",(0,s.jsxs)(n.li,{children:["toggle [",(0,s.jsx)(n.strong,{children:"p"}),"]honograph as input source"]}),"\n",(0,s.jsxs)(n.li,{children:["[",(0,s.jsx)(n.strong,{children:"f"}),"]orwards track"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["front row of keyboard buttons","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["toggle [",(0,s.jsx)(n.strong,{children:"t"}),"]v speaker"]}),"\n",(0,s.jsxs)(n.li,{children:["toggle [",(0,s.jsx)(n.strong,{children:"l"}),"]iving room speaker"]}),"\n",(0,s.jsxs)(n.li,{children:["toggle [",(0,s.jsx)(n.strong,{children:"k"}),"]itchen speaker"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["the rotary knob has 3 triggers","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["turning clockwise (",(0,s.jsx)(n.code,{children:"cw"}),") -> [",(0,s.jsx)(n.strong,{children:"u"}),"]p"]}),"\n",(0,s.jsxs)(n.li,{children:["turning counterclockwise (",(0,s.jsx)(n.code,{children:"ccw"}),") -> [",(0,s.jsx)(n.strong,{children:"d"}),"]own"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"press"})," -> toggle [",(0,s.jsx)(n.strong,{children:"m"}),"]ute"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'#  buttons on the left, knobs on the right\norientation: normal\n\nrows: 2\ncolumns: 3\nknobs: 1\n\nlayers:\n  - buttons:\n      - ["b", "p", "f"]\n      - ["t", "l", "k"]\n    knobs:\n      - ccw: "d"\n        press: "m"\n        cw: "u"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Installing was straightforward and well-documented; check out"}),"\n",(0,s.jsxs)(n.p,{children:["The keyboard chip supports multiple layers, but there's no way to switch them without a preinstalled physical toggle, and my keyboard had none; I didn't bother with multiple ",(0,s.jsx)(n.code,{children:"layers"}),' entries. I did mourn the lack of QMK-style "send a keycode when tapping a given key, but act as a modifier when held" functionality: I would love to be able to make it so that holding some speaker\'s toggle key would let me temporarily manage the group members and volume of ',(0,s.jsx)(n.em,{children:"its"})," group, but node per se doesn't distinguish between keyup and keydown events, so without firmware support, I can't do anything that fancy without a grip of additional setup; this one had to stay on the cutting room floor."]}),"\n","\n",(0,s.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,s.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{id:"user-content-fn-5",children:["\n",(0,s.jsxs)(n.p,{children:["RGB lighting ",(0,s.jsx)(n.em,{children:"is"})," technically a feature of this keyboard, and I started out with hopes of lighting up specific keys to show which speakers were connected. I thought it would useful and rad, and I still do. But the only controls available were some predefined full-keyboard light patterns which could only be triggered en masse, not on a per-key basis, and only by an external signal from the computer it's plugged into. So it goes. ",(0,s.jsx)(n.a,{href:"#user-content-fnref-5","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(6540);const s={},r=o.createContext(s);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);