"use strict";(self.webpackChunkambirdsall_com=self.webpackChunkambirdsall_com||[]).push([[1232],{1512:(e,t,i)=>{i.d(t,{A:()=>l});i(6540);var n=i(6143),s=i(253),a=i(5542);class r{#e;#t=216.5;#i=150;#n=2e3;#s=1;constructor(e){this.#e=e,this.initPoints(),this.initVisualization()}initPoints(){this.vertices=[(0,a.bR)(this.#t,this.#i),(0,a.bR)(0,this.#i),(0,a.bR)(this.#t/2,0)],this.points=new a.Jn([...this.vertices],{maxSize:this.#n,minSize:this.#s}),this.current=(0,a.bR)(this.#t/2,this.#i/2),this.points.push(this.current)}initVisualization(){this.svg=(0,s.Ltv)(this.#e).insert("svg",".name").attr("width",this.#t).attr("height",this.#i).attr("style","background: white"),this.x=(0,s.m4Y)().domain([0,this.#t]).range([10,this.#t-10]),this.y=(0,s.m4Y)().domain([0,this.#t]).range([10,this.#t-10])}update(){const e=this.svg.selectAll("circle").data(this.points.data);e.exit().remove(),e.enter().append("circle").attr("r",2).style("fill","#aa9668"),e.attr("cx",(e=>this.x(e.x))).attr("cy",(e=>this.y(e.y)))}}var o=i(4848);const h=e=>{const t=new r(e);t.update(),t.update()},l=()=>(0,o.jsx)(n.A,{d3RenderFn:h,className:"triangle big-bottom"})},3991:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(6540),s=i(6143),a=i(253),r=i(5542);class o{#e;#t=216.5;#i=150;#a=18;#n=2e3;#s=60;#r=this.#n;constructor(e){this.#e=e,this.initPoints(),this.initVisualization(),this.points.resize(this.#a),this.resize(this.#a)}initPoints(){this.vertices=[(0,r.bR)(0,0),(0,r.bR)(this.#t,0),(0,r.bR)(this.#t/2,this.#i)],this.points=new r.Jn([...this.vertices],{maxSize:this.#n,minSize:this.#s}),this.current=(0,r.bR)(this.#t/2,this.#i/2),this.points.push(this.current)}initVisualization(){const e=this.resize;this.svg=(0,a.Ltv)(this.#e).insert("svg",".name").attr("width",this.#t).attr("height",this.#i);const t=(0,a.Ltv)(this.#e).insert("div").attr("class","resizer").style("margin-top","2em");this.sliderLabel=t.insert("label").attr("for","triangle-point-selector").style("display","block").style("text-align","center").style("color","rgba(170, 150, 104, 1)"),t.insert("input").attr("type","range").attr("id","triangle-point-selector").style("justify-self","center").style("width","216.5px").attr("value",`${this.#a}`).on("input",(function(){e(+this.value)})).append("span").text((function(){return this.value})),this.x=(0,a.m4Y)().domain([0,this.#t]).range([10,this.#t-10]),this.y=(0,a.m4Y)().domain([0,this.#t]).range([10,this.#t-10])}resize=e=>{const t=e/100*this.#n;this.#r=this.points.safeMax(t)};update(){const e=this.svg.selectAll("circle").data(this.points.data);e.exit().remove(),e.enter().append("circle").attr("r",1).style("fill","#aa9668"),e.attr("cx",(e=>this.x(e.x))).attr("cy",(e=>this.y(e.y))),this.sliderLabel.html((()=>`<i>Number of points:</i> ${this.points.length()}`))}addNextPoint(){const e=this.current,t=(0,r.XM)(this.vertices);this.current=(0,r.Rj)(e,t),this.points.push(this.current)}drawSomeDots(e){this.correctSizeBy(e);for(let t=0;t<e;++t)this.addNextPoint();this.update()}correctSizeBy(e){const t=this.#r-this.points.maxSize;if(t>0){const i=Math.min(e,t);this.points.resizeBy(i)}else if(t<0){const i=0-Math.min(e,0-t);this.points.resizeBy(i)}}run(){(0,a.YPD)((()=>this.drawSomeDots(11)),10)}}var h=i(4848);function l(){const e=(0,n.useCallback)((e=>{new o(e).run()}),[]);return(0,h.jsx)(s.A,{d3RenderFn:e,className:"triangle"})}},5542:(e,t,i)=>{i.d(t,{Jn:()=>r,Rj:()=>s,XM:()=>a,bR:()=>n});const n=(e,t)=>({x:e,y:t}),s=(e,t)=>{const i=(e.x+t.x)/2,s=(e.y+t.y)/2;return n(i,s)},a=e=>e[Math.floor(Math.random()*e.length)];class r{constructor(e,t){void 0===e&&(e=[]);let{maxSize:i,minSize:n}=t;this.data=e,this.actualMax=i||2e3,this.actualMin=n||60,this.maxSize=this.actualMax}#o(){for(;this.data.length>=this.maxSize;)this.data.shift()}push(e){this.data.push(e),this.#o()}safeMax(e){const t=Math.max(e,this.actualMin);return Math.min(t,this.actualMax)}resize(e){const t=this.safeMax(e);return this.maxSize=t,this.#o(),t}resizeToPct(e){const t=e/100*this.actualMax;return this.resize(t)}resizeBy(e){return this.resize(this.maxSize+e)}length(){return this.data.length}}},5785:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>n,toc:()=>u});var n=i(6830),s=i(4848),a=i(8453),r=i(3991),o=i(1512),h=i(6803);const l={slug:"on-the-sierpinski-triangle-thing",title:"On that fractal triforce thing there",topic:"M E T A B L A G",date:new Date("2024-05-09T00:00:00.000Z")},d=void 0,c={authorsImageUrls:[]},u=[{value:"The setup",id:"the-setup",level:2},{value:"Complex behaviors can emerge from simple rules, or: let&#39;s hang some mathy flesh on those bones",id:"complex-behaviors-can-emerge-from-simple-rules-or-lets-hang-some-mathy-flesh-on-those-bones",level:2},{value:"But is it Web Scale?",id:"but-is-it-web-scale",level:2}];function m(e){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Let's talk a little about how (and why) I built this:"}),"\n",(0,s.jsx)(r.A,{}),"\n","\n",(0,s.jsx)(t.p,{children:"Play around with it a little\u2014it's kind of cool, right? I can never decide if I prefer the\nsparsely- and densely-populated version."}),"\n",(0,s.jsxs)(t.p,{children:["It's also sentimental for me. Let's go back in time a little: in 2013, I was earning an\nextremely meager living running an after-school art program at a local elementary school.\nMy original dream of a tenure-track professorship in the humanities had foundered on the\nsharp realities of the great recession and the increasingly exploitative academic job\nmarket for teachers of every subject that lacked a corresponding industry to provide\nnegotiating leverage. I had no clue what might be a sustainable long-term career, but I\nknew that status quo wasn't it; and though I love children, after spending so many of my\nwaking hours dealing with 10-year-olds and their  10-year-old thoughts, I could feel the\nsharp edges of my brain beginning to dull ",(0,s.jsx)(t.sup,{children:(0,s.jsx)(t.a,{href:"#user-content-fn-1-8ec768",id:"user-content-fnref-1-8ec768","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),". I needed to find something I could do with\nmy brain that would be"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"difficult enough to be interesting, and"}),"\n",(0,s.jsx)(t.li,{children:"remunerative;"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"and by and by my search lead me to enroll in CS101 at a local community college. I didn't enroll with the thought of becoming a programmer per se\u2014I just thought it would help if I ended up doing any kind of work crunching numbers. But I loved it, I was good at it, and it really did transform my life. But this isn't about all that: this is about an Extremely Cool demo the teacher ran one day in class."}),"\n",(0,s.jsx)(t.h2,{id:"the-setup",children:"The setup"}),"\n",(0,s.jsx)(t.p,{children:"The teacher walked us through a very simple C++ program. It imported some graphics library\nheaders, the details of which were glossed over (it was a 101 course, after all), and then\ndefined a very simple initial state:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"a small cartesian grid"}),"\n",(0,s.jsxs)(t.li,{children:["an array of three points on that grid corresponding to the vertices of a triangle, each defined as a two-element array of ",(0,s.jsx)(t.code,{children:"float"}),"s"]}),"\n",(0,s.jsxs)(t.li,{children:["another point near the middle of the other three, assigned to a variable like ",(0,s.jsx)(t.code,{children:"currentPoint"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"If we were to stop here and only render the initial state, it would look something like this:"}),"\n",(0,s.jsx)(o.A,{}),"\n",(0,s.jsx)(t.p,{children:"Not very exciting yet, I admit."}),"\n",(0,s.jsx)(t.h2,{id:"complex-behaviors-can-emerge-from-simple-rules-or-lets-hang-some-mathy-flesh-on-those-bones",children:"Complex behaviors can emerge from simple rules, or: let's hang some mathy flesh on those bones"}),"\n",(0,s.jsxs)(t.p,{children:["To expand on this rather spartan, boring starting point, there was a single ",(0,s.jsx)(t.code,{children:"for"})," loop, which did the following steps a few thousand times:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"select a random element from the array of vertices"}),"\n",(0,s.jsxs)(t.li,{children:["calculate the coordinates of the point halfway between ",(0,s.jsx)(t.code,{children:"currentPoint"})," and that vertex"]}),"\n",(0,s.jsxs)(t.li,{children:["reassign ",(0,s.jsx)(t.code,{children:"currentPoint"})," to that new point"]}),"\n",(0,s.jsxs)(t.li,{children:["draw the new ",(0,s.jsx)(t.code,{children:"currentPoint"})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Very simple stuff, maybe 15 lines of code total. A well-read observer may recognize this\nas a simple variant of ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Chaos_game",children:"the chaos game"}),"\nalgorithm; at the time, I didn't recognize shit. But I am the child of a math teacher and\nan older millenial who has been playing Zelda games since the delirious days of Clinton vs\nDole vs Perot, short pants, and gold NES cartridges: the teacher compiled the script, ran\nthe binary, and it sparked joy:"]}),"\n",(0,s.jsx)(h.A,{}),"\n",(0,s.jsx)(t.h2,{id:"but-is-it-web-scale",children:"But is it Web Scale?"}),"\n",(0,s.jsx)(t.p,{children:"So, we have the core algorithm for drawing a cool little fractal triforce. Now to stick in in a website!"}),"\n",(0,s.jsx)(t.p,{children:"I made a few artistic choices:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"inverting the triangle makes it look like it's pointing down at the content below in a nice way"}),"\n",(0,s.jsx)(t.li,{children:"naively adding points fills in the triangle with monotonically increasing density, the visual effect of which has sharply diminishing returns; pushing the points into a FIFO queue with a max size preserves the negative space it needs to look sparse, dynamic, and alive"}),"\n",(0,s.jsx)(t.li,{children:"I wanted users to be able to  interactively adjust the number of dots in the visualization: it leans into the dynamic nature of the web as a medium; it allows folks to experience both the frenetic movement and staticky geometric ambiguity of a sparsely-populated queue of points and the fractal beauty of a denser one; and it shows potential employers that I am reasonably competent at connecting user inputs to dynamic logic, which, I mean, ain't nothing."}),"\n",(0,s.jsxs)(t.li,{children:["The gold color (",(0,s.jsx)(t.code,{children:"#aa9668"}),", for those of you who are curious but don't actually want to pin down an ephemeral svg ",(0,s.jsx)(t.code,{children:"<circle>"})," in your browser's devtools) goes nicely with the rest of the site"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The last order of business, then, was to actually render those dots. This site is built on\ntop of a react-based static site generator; while there is a lot to like about react, it's\nnot a great choice for making performant little mathy visualizations. I decided to use d3\nfor that. However, d3 and react both want to control the rendering of your html. How to\nmake them play nicely together? Like this:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"export default function D3Wrapper({ d3RenderFn, className }) {\n  // d3 needs an actual DOM node to do its thing on, so let's give it one\n  const el = useRef(null)\n\n  // Render the d3 visualization. If the d3 visualization is already in the DOM, though,\n  // do not recreate it; this avoids duplicated element shenanigans with hot module\n  // reloading during development.\n  useEffect(() => {\n    if (!window.d3Embeds) {\n      window.d3Embeds = new Map()\n    }\n\n    if (!window.d3Embeds.get(d3RenderFn)) {\n      d3RenderFn(el.current)\n      window.d3Embeds.set(d3RenderFn, true)\n    }\n  }, [d3RenderFn])\n\n  return <div className={className} ref={el} />\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"And really, that's it. A cute little bit of web-based art that makes me happy."}),"\n","\n",(0,s.jsxs)(t.section,{"data-footnotes":!0,className:"footnotes",children:[(0,s.jsx)(t.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{id:"user-content-fn-1-8ec768",children:["\n",(0,s.jsxs)(t.p,{children:["I should note here that this is not a fundamental fact of dealing with kids: parents and school teachers have the chance (the obligation, even) to engage more deeply with their kids, and tracking those longer-term educational goals to the kids' intellectual and emotional development provides as deep an intellectual challenge as you care to make it. Hanging out for two hours doodling on butcher paper and helping with the stultifying abolination that is second-grade homework ",(0,s.jsx)(t.sup,{children:(0,s.jsx)(t.a,{href:"#user-content-fn-2-8ec768",id:"user-content-fnref-2-8ec768","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),", though? I needed more. ",(0,s.jsx)(t.a,{href:"#user-content-fnref-1-8ec768","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{id:"user-content-fn-2-8ec768",children:["\n",(0,s.jsxs)(t.p,{children:["Up until ",(0,s.jsx)(t.em,{children:"at least"})," the start of adolescence, children's intellectual and social development requires free, exploratory play, not rote drilling of skills; and their emotional and executive regulation is not strong enough to get any long-term benefit from the discipline of finishing their daily assignments. But by all means, if you want to force parents to force their kids into boring, tedious chorework, keep it coming! ",(0,s.jsx)(t.a,{href:"#user-content-fnref-2-8ec768","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},6143:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(6540),s=i(4848);function a(e){let{d3RenderFn:t,className:i}=e;const a=(0,n.useRef)(null);return(0,n.useEffect)((()=>{window.d3Embeds||(window.d3Embeds=new Map),window.d3Embeds.get(t)||(t(a.current),window.d3Embeds.set(t,!0))}),[t]),(0,s.jsx)("div",{className:i,ref:a})}},6803:(e,t,i)=>{i.d(t,{A:()=>l});i(6540);var n=i(6143),s=i(253),a=i(5542);class r{#e;#t=216.5;#i=150;#n=1e4;#s=60;#r=this.#n;constructor(e){this.#e=e,this.initPoints(),this.initVisualization(),this.update(),this.points.resize(this.#n)}initPoints(){this.vertices=[(0,a.bR)(this.#t,this.#i),(0,a.bR)(0,this.#i),(0,a.bR)(this.#t/2,0)],this.points=new a.Jn([...this.vertices],{maxSize:this.#n,minSize:this.#s}),this.current=(0,a.bR)(this.#t/2,this.#i/2),this.points.push(this.current)}initVisualization(){this.svg=(0,s.Ltv)(this.#e).insert("svg",".name").attr("width",this.#t).attr("height",this.#i).attr("style","background: white"),this.x=(0,s.m4Y)().domain([0,this.#t]).range([10,this.#t-10]),this.y=(0,s.m4Y)().domain([0,this.#t]).range([10,this.#t-10])}update(){const e=this.svg.selectAll("circle").data(this.points.data);e.exit().remove(),e.enter().append("circle").attr("r",1).style("fill","#aa9668"),e.attr("cx",(e=>this.x(e.x))).attr("cy",(e=>this.y(e.y)))}addNextPoint(){const e=this.current,t=(0,a.XM)(this.vertices);this.current=(0,a.Rj)(e,t),this.points.push(this.current)}drawSomeDots(e){for(let t=0;t<e;++t)this.addNextPoint();this.update()}run(){this.drawSomeDots(1e4),this.update()}}var o=i(4848);const h=e=>{new r(e).run()},l=()=>(0,o.jsx)(n.A,{d3RenderFn:h,className:"triangle big-bottom"})},6830:e=>{e.exports=JSON.parse('{"permalink":"/blog/on-the-sierpinski-triangle-thing","source":"@site/blog/sierpinski-triangle-thing.mdx","title":"On that fractal triforce thing there","description":"Let\'s talk a little about how (and why) I built this:","date":"2024-05-09T00:00:00.000Z","tags":[],"readingTime":5.4,"hasTruncateMarker":true,"authors":[],"frontMatter":{"slug":"on-the-sierpinski-triangle-thing","title":"On that fractal triforce thing there","topic":"M E T A B L A G","date":"2024-05-09T00:00:00.000Z"},"unlisted":false,"lastUpdatedAt":1745535817000,"prevItem":{"title":"Why is date formatting so hard in vanilla JS?","permalink":"/blog/vanilla-js-date-formatting"},"nextItem":{"title":"Rewriting a middleman site with gatsby","permalink":"/blog/cut-out-the-middleman"}}')},8453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>o});var n=i(6540);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);